(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[10],{237:function(e,t,a){},342:function(e,t,a){"use strict";a.r(t);var s=a(136),n=a(15),r=a.n(n),c=a(38),o=a(5),i=a(0),l=a(277),d=a(61),j=a(10),u=a(276),b=a(231),p=a(232),h=(a(237),a(44)),O=a.n(h),x=a(60),m=a(2),w=function(e){var t=Object(i.useState)(!1),a=Object(o.a)(t,2),s=a[0],n=a[1],l=Object(i.useState)({email:"",password:"",is_admin:!1}),h=Object(o.a)(l,2),w=h[0],f=h[1],g=Object(i.useState)({email:!1,password:!1}),v=Object(o.a)(g,2),S=v[0],k=v[1],C=Object(i.useState)({err:!1,text:"Enter the user's details"}),y=Object(o.a)(C,2),z=y[0],I=y[1],N=function(e,t){var a=t.name,s=t.value;k(Object(j.a)(Object(j.a)({},S),{},Object(d.a)({},a,!1))),f(Object(j.a)(Object(j.a)({},w),{},Object(d.a)({},a,s)))},P=function(){var t=Object(c.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(k({email:!1,password:!1}),w.password&&w.email){t.next=5;break}k({email:!0,password:!0}),t.next=9;break;case 5:return n(!0),I({err:!1,text:"Please wait..."}),t.next=9,O.a.post("".concat("","/api/auth/users"),w).then((function(t){n(!1),e.handleUpdateUser(w),e.handleAddUser(),I({err:!1,text:"Enter the user's details"})})).catch((function(e){k(Object(j.a)(Object(j.a)({},S),{},{password:!0,email:!0})),e.response?(I({err:!0,text:e.response.data.msg}),console.log(e.response.data)):I({err:!0,text:"Internal server error."}),n(!1)}));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(m.jsxs)(u.a,{closeIcon:!0,open:e.open,onClose:function(){e.handleAddUser(),k({email:!1,password:!1}),f({password:null,email:null}),I({err:!1,text:"Enter user's details"})},children:[Object(m.jsx)(u.a.Header,{children:"Create New User"}),Object(m.jsx)("p",{className:"".concat(z.err&&"text-danger"," font-weight-light text-center status-text pt-4 pb-0"),children:z.text}),Object(m.jsx)(u.a.Content,{className:"mb-4",children:Object(m.jsx)(x.Fade,{children:Object(m.jsxs)(b.a,{className:" mb-3",loading:s,onSubmit:P,children:[Object(m.jsx)(b.a.Input,{icon:"envelope",name:"email",error:S.email,iconPosition:"left",placeholder:"Email address",onChange:N,value:w.email}),Object(m.jsx)(b.a.Input,{icon:"lock",name:"password",error:S.password,iconPosition:"left",placeholder:"Password",type:"password",size:"large",onChange:N,value:w.password}),Object(m.jsx)(b.a.Checkbox,{name:"is_admin",toggle:!0,label:"Make this user an admin",onChange:function(e,t){var a=t.name,s=t.checked;f(Object(j.a)(Object(j.a)({},w),{},Object(d.a)({},a,s)))},defaultChecked:w.is_admin}),Object(m.jsx)(p.a,{fluid:!0,color:"blue",size:"large",children:"Login"})]})})})]})},f=a(85),g=a(250),v=a(230),S=a(340),k=function(e){var t=Object(i.useState)(!1),a=Object(o.a)(t,2),s=a[0],n=a[1],l=Object(i.useState)({password2:"",password:""}),h=Object(o.a)(l,2),x=h[0],w=h[1],f=Object(i.useState)({password:!1,password2:!1}),g=Object(o.a)(f,2),v=g[0],S=g[1],k=Object(i.useState)({err:!1,text:"Change password"}),C=Object(o.a)(k,2),y=C[0],z=C[1],I=function(e,t){var a=t.name,s=t.value;S(Object(j.a)(Object(j.a)({},v),{},Object(d.a)({},a,!1))),w(Object(j.a)(Object(j.a)({},x),{},Object(d.a)({},a,s)))},N=function(){var t=Object(c.a)(r.a.mark((function t(){var a,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=localStorage.getItem("TKID"),S({password2:!1,password:!1}),x.password&&x.password2){t.next=6;break}S({password:!0,password2:!0}),t.next=16;break;case 6:if(x.password===x.password2){t.next=11;break}S({password:!0,password2:!0}),z({err:!0,text:"Passwords do not match."}),t.next=16;break;case 11:return n(!0),z({err:!1,text:"Please wait..."}),s={headers:{Authorization:"Bearer ".concat(a)}},t.next=16,O.a.put("".concat("","/api/auth/user/").concat(e.id,"/change_password"),x,s).then((function(){n(!1),e.handleShowPasswordReset(),z({err:!1,text:"Change password"})})).catch((function(e){n(!1),S({password:!0,password2:!0}),e.response?(console.log(e.response.data),z({err:!0,text:e.response.data.msg})):(console.log(e),z({err:!0,text:"There was an error."}))}));case 16:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(m.jsxs)(u.a,{closeIcon:!0,open:e.open,onClose:function(){e.handleShowPasswordReset(),S({password2:!1,password:!1}),w({}),z({err:!1,text:"Change password"})},children:[Object(m.jsx)(u.a.Header,{children:"Reset Password"}),Object(m.jsx)("p",{className:"".concat(y.err&&"text-danger"," font-weight-light text-center status-text pt-5 pb-0"),children:y.text}),Object(m.jsx)(u.a.Content,{className:"mb-4",children:Object(m.jsxs)(b.a,{className:" mb-3",loading:s,onSubmit:N,children:[Object(m.jsx)(b.a.Input,{icon:"lock",name:"password",error:v.password,iconPosition:"left",placeholder:"Enter password",type:"password",size:"large",onChange:I}),Object(m.jsx)(b.a.Input,{icon:"lock",name:"password2",error:v.password2,iconPosition:"left",placeholder:"Confirm password",type:"password",size:"large",onChange:I}),Object(m.jsx)(p.a,{fluid:!0,color:"blue",size:"large",children:"Submit"})]})})]})};t.default=function(){var e=Object(i.useState)(!1),t=Object(o.a)(e,2),a=t[0],n=t[1],d=Object(i.useState)(!1),j=Object(o.a)(d,2),u=j[0],b=j[1],h=Object(i.useState)([]),x=Object(o.a)(h,2),C=x[0],y=x[1],z=Object(i.useState)({}),I=Object(o.a)(z,2),N=I[0],P=I[1],_=Object(i.useState)(!1),U=Object(o.a)(_,2),A=U[0],E=U[1],T=Object(i.useState)(!1),R=Object(o.a)(T,2),B=R[0],D=R[1],H=localStorage.getItem("_id");Object(i.useEffect)((function(){(function(){var e=Object(c.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("TKID"))){e.next=6;break}return E(!0),a={headers:{Authorization:"Bearer ".concat(t)}},e.next=6,O.a.get("".concat("","/api/auth/users"),a).then((function(e){y(e.data.users),E(!1)})).catch((function(e){E(!1),D(!0),e.response?console.log(e.response.data):console.log(e)}));case 6:E(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var K=function(){var e=Object(c.a)(r.a.mark((function e(t){var a,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=localStorage.getItem("TKID"),E(!0),s={headers:{Authorization:"Bearer ".concat(a)}},e.next=5,O.a.delete("".concat("","/api/auth/user/").concat(t),s).then((function(){var e=C.filter((function(e){return e._id!==t}));y(e),E(!1)})).catch((function(e){E(!1),D(!0),e.response?console.log(e.response.data):console.log(e)}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return B?Object(m.jsxs)("div",{style:{fontSize:"1.6rem"},children:[Object(m.jsx)(f.a,{name:"warning sign",size:"large",color:"red"}),Object(m.jsx)("p",{children:"Oops! There was an error loading data."})]}):Object(m.jsxs)(m.Fragment,{children:[A?Object(m.jsx)(g.a,{style:{minHeight:300},children:Object(m.jsx)(v.a,{size:"large",active:A,children:"Loading"})}):Object(m.jsxs)(l.a,{bordered:!0,hover:!0,responsive:!0,className:"bg-white",children:[Object(m.jsx)("thead",{children:Object(m.jsx)("tr",{children:Object(m.jsx)("th",{colSpan:"5",children:Object(m.jsxs)(p.a,{floated:"right",icon:!0,labelPosition:"left",primary:!0,size:"small",onClick:function(){return n(!0)},children:[Object(m.jsx)(f.a,{name:"plus"})," New"]})})})}),Object(m.jsx)("tbody",{children:C.map((function(e,t){return Object(m.jsxs)("tr",{children:[Object(m.jsxs)("td",{className:"h5 text-left",children:[e.email," ",e.is_admin&&Object(m.jsx)(f.a,{name:"key",color:"grey",size:"small"})]}),Object(m.jsxs)("td",{className:"text-center",children:[Object(m.jsx)("span",{children:Object(m.jsx)(p.a,{className:"m-1",size:"mini",color:"blue",icon:"pencil",onClick:function(){b(!0),P(e)}})}),Object(m.jsx)("span",{children:Object(m.jsx)(S.a,{trigger:Object(m.jsx)(p.a,{className:"m-1",color:"red",size:"mini",icon:"delete",disabled:e._id===H}),header:Object(m.jsx)("h5",{className:"mb-3",children:"Are you sure you want to delete this user?"}),content:Object(m.jsx)(p.a,{color:"red",content:"Yes",onClick:function(){return K(e._id)}}),on:"click",position:"top right"})})]})]},t)}))})]}),Object(m.jsx)(w,{handleAddUser:function(){n(!a)},handleUpdateUser:function(e){y([].concat(Object(s.a)(C),[e]))},open:a}),Object(m.jsx)(k,{handleShowPasswordReset:function(){b(!u)},open:u,id:N._id})]})}}}]);
//# sourceMappingURL=10.b641c341.chunk.js.map